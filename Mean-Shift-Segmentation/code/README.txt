I separate the gray image process and the color image process.
when you process the gray image, please run the main_gray.m
when you process the color image, please run the main_color.m